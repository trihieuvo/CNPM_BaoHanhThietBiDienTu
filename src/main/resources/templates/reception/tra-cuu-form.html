<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<body>

<div th:fragment="content">
    <div class="header">
        <div>
            <h1>Tra cứu thông tin sửa chữa</h1>
            <p class="text-muted">Nhập mã phiếu, SĐT hoặc tên khách hàng để tìm kiếm.</p>
        </div>
    </div>

    <div class="card mb-4">
        <form th:action="@{/receptionist/tra-cuu}" method="get" class="search-box">
            <input type="text" name="query" class="form-control" placeholder="Nhập thông tin tìm kiếm..." th:value="${query}" autofocus>
            <button type="submit" class="btn"><i class="fa-solid fa-search"></i> Tìm kiếm</button>
        </form>
    </div>

    <div class="card">
        <h3>Kết quả tìm kiếm</h3>

        <div th:if="${query == null}" class="empty-state">
             <div><i class="fa-solid fa-magnifying-glass"></i></div>
             <p>Vui lòng nhập thông tin vào ô tìm kiếm phía trên.</p>
        </div>
        
        <div th:if="${query != null and results.isEmpty()}" class="empty-state">
            <div><i class="fa-solid fa-box-open"></i></div>
             <h4>Không tìm thấy kết quả</h4>
             <p>Không có phiếu sửa chữa nào phù hợp với từ khóa <strong th:text="${query}"></strong>.</p>
        </div>

        <div th:if="${!results.isEmpty()}">
            <p class="text-muted mb-3">Tìm thấy <strong th:text="${#lists.size(results)}"></strong> kết quả phù hợp.</p>
            <table>
                <thead>
                    <tr>
                        <th>Mã Phiếu</th>
                        <th>Khách Hàng</th>
                        <th>Số Điện Thoại</th>
                        <th>Thiết Bị</th>
                        <th>Trạng Thái</th>
                        <th>Ngày Tiếp Nhận</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="phieu : ${results}">
                        <td><strong th:text="'#' + ${phieu.maPhieu}">#123</strong></td>
                        <td th:text="${phieu.khachHang.hoTen}">Nguyễn Văn A</td>
                        <td th:text="${phieu.khachHang.soDienThoai}">0987654321</td>
                        <td th:text="${phieu.thietBi.hangSanXuat + ' ' + phieu.thietBi.model}">Dell Inspiron</td>
                        <td>
                            <span class="badge badge-info" th:text="${phieu.trangThai}">Mới tiếp nhận</span>
                        </td>
                        <td th:text="${#temporals.format(phieu.ngayTiepNhan, 'dd/MM/yyyy HH:mm')}">15/10/2025</td>
                        <td>
                            <a th:href="@{/receptionist/tra-cuu/{id}(id=${phieu.maPhieu})}" class="btn btn-outline">Xem chi tiết</a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

</body>
</html>