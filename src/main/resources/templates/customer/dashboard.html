<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trang ch·ªß - Kh√°ch h√†ng</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <style>
        /* C√°c style c≈© nh∆∞ .welcome-section, .stats-grid, .quick-actions ƒë√£ ƒë∆∞·ª£c chuy·ªÉn v√†o style.css ho·∫∑c kh√¥ng c√≤n c·∫ßn thi·∫øt */
        /* B·∫°n c√≥ th·ªÉ gi·ªØ l·∫°i c√°c style ƒë·∫∑c th√π cho trang n√†y n·∫øu c·∫ßn */
    </style>
</head>
<body>

    <div th:replace="~{customer/fragments :: sidebar(activePage='dashboard', khachHang=${khachHang})}"></div>

    <div class="main-content">
        <div class="welcome-section">
            <h1>Xin ch√†o, <span th:text="${khachHang.hoTen}">Kh√°ch h√†ng</span>!</h1>
            <p>Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi h·ªá th·ªëng qu·∫£n l√Ω b·∫£o h√†nh</p>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="icon">üì±</div>
                <div class="number" th:text="${soThietBi}">0</div>
                <div class="label">Thi·∫øt b·ªã</div>
            </div>
            <div class="stat-card">
                <div class="icon">üîß</div>
                <div class="number" th:text="${soPhieuSua}">0</div>
                <div class="label">Phi·∫øu s·ª≠a ch·ªØa</div>
            </div>
        </div>

        <div class="recent-section">
            <h2 style="margin-bottom: 16px;">Phi·∫øu s·ª≠a ch·ªØa g·∫ßn ƒë√¢y</h2>
            
            <div th:if="${danhSachPhieu.isEmpty()}" style="text-align: center; padding: 40px 0; color: #64748b;">
                <div style="font-size: 48px; margin-bottom: 16px;">üì≠</div>
                <p>Ch∆∞a c√≥ phi·∫øu s·ª≠a ch·ªØa n√†o</p>
            </div>

            <table th:if="${!danhSachPhieu.isEmpty()}">
                <thead>
                    <tr>
                        <th>M√£ phi·∫øu</th>
                        <th>Thi·∫øt b·ªã</th>
                        <th>Ng√†y ti·∫øp nh·∫≠n</th>
                        <th>Tr·∫°ng th√°i</th>
                        <th>Chi ph√≠</th>
                        <th>H√†nh ƒë·ªông</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="phieu, iterStat : ${danhSachPhieu}" th:if="${iterStat.index < 5}">
                        <td><strong th:text="${phieu.maPhieu}"></strong></td>
                        <td th:text="${phieu.thietBi.hangSanXuat + ' ' + phieu.thietBi.model}"></td>
                        <td th:text="${#temporals.format(phieu.ngayTiepNhan, 'dd-MM-yyyy HH:mm')}"></td>
                        <td>
                            <span class="badge" 
                                  th:classappend="${phieu.trangThai == 'ƒê√£ tr·∫£ kh√°ch'} ? 'badge-success' : 
                                                  (${phieu.trangThai == 'ƒêang s·ª≠a ch·ªØa'} ? 'badge-warning' : 
                                                  (${phieu.trangThai == 'ƒê√£ s·ª≠a xong'} ? 'badge-info' : 'badge-danger'))"
                                  th:text="${phieu.trangThai}">
                            </span>
                        </td>
                        <td>
                            <span th:if="${phieu.tongChiPhi != null}" 
                                  th:text="${#numbers.formatDecimal(phieu.tongChiPhi, 0, 'COMMA', 0, 'POINT') + ' VNƒê'}">
                            </span>
                            <span th:unless="${phieu.tongChiPhi != null}">Ch∆∞a t√≠nh</span>
                        </td>
                        <td>
                            <a th:href="@{/customer/phieu-sua-chua/{id}(id=${phieu.maPhieu})}" class="link">
                                Xem chi ti·∫øt
                            </a>
                        </td>
                    </tr>
                </tbody>
            </table>

            <div th:if="${!danhSachPhieu.isEmpty() && danhSachPhieu.size() > 5}" style="text-align: center; margin-top: 16px;">
                <a href="/customer/lich-su-bao-hanh" class="btn btn-outline">Xem t·∫•t c·∫£</a>
            </div>
        </div>
    </div>

</body>
</html>